# 组件设计和数据状态设计

标签（空格分隔）： vue 组件设计

---

### 状态设计的思路和要点

思路：
1.用数据完整描述内容
2.数据结构化：数据类型一般为数组或者对象类型，易于程序操作如遍历和查询
3.数据可扩展：预防pm添加需求

步骤：
1.根据原型图设计出数据结构：如购物车，完成这个功能用什么样的数据类型存储合适，显然这里使用数组存储所有商品，数组每条项就是每件商品的信息，因此每个数组元素应该选择对象类型，对象里面可以存储商品的价格、类别、价格、控制组件需要的信息、唯一id等。
2.用数据描述内容：区分功能和内容。功能即操作数据的方法，比如查询、添加、删除均为功能。内容即可以存储和后端进行交互的东西。
3.数据结构化：如上的数据结构可以添加和删除。
4.数据可扩展：数组项设计为对象

### 组件设计的思路和要点
原则：
1.从功能上拆分层次：父子关系->父子组件、兄弟组件
2.组件原子化：将复杂功能拆分成每个小功能
3.区分容器组件和UI组件：容器组件只管理数据，UI组件只展示视图。（比如点击按钮，列表），点击之后把数据交给容器组件处理。比如购物车中，分为父组件、搜索组件、列表组件，父组件为容器组件，搜索组件和列表组件为UI组件。搜索组件点击搜索之后只负责将数据交给容器组件，其它不管。列表组件只负责从容器组件里取数据然后显示，其它删除功能和确认功能从父组件中调用方法与列表组件无关。
Demo:

```
//结构
<App> //容器组件，只管理数据
    <CarList> //商品列表
        <CarItem></CarItem>
        <CarItem></CarItem>
        <CarItem></CarItem>
    </CarList>
    <Home> //购物车列表和总价
        <Item></Item>
    </Home>
</App>
```

```
//实际
<template>
    <div id="nav">
        <router-link to="/"></router-link>
        <router-link to="/cart"></router-link>
        <router-view></router-view>>
    </div>
</template>
```

案例实现：购物车
遵循：由外到内，由整体到细节，由简单到复杂
必须思考的问题：一个组件我需要什么样的数据，我需要实现什么样的功能，为此我需要传递什么数据，

1. 第一步：拆分组件，配置router.vue路由，完成APP.vue的根样式和根页面模板;
2. 第二步：数据状态设计，配置测试数据。如：将设计好的数据编写成一个json文件或者js文件并导出数据。
3. 第三步：完善父组件的模板和样式（先写结构，后写数据和方法，最后写样式。），引入测试数据和子组件，如:把home.vue模板当作父组件,完善home.vue样式和模板，data引入数据，components引入组件。
4. 第四步：在父组件中模板中使用子组件,为子组件传入初始数据，方法。
5. 第五步：在子组件中接收数据并完善模板,为模板添加样式,数据渲染以及组件通信的事件

github:
如何判断什么时候需要store的数据,如果一个组件中的数据不是初始获取可以直接渲染在页面上的，而是需要经过暂时存储的并且需要与其它兄弟组件共享的。如上面的购物车里的数据，一开始并不存在，而是用户操作之后存在的。而商品列表是一开始获取而不需要用户操作的。并且在商品详细列表组件中添加至购物车属于兄弟组件之间的数据传递。

如何判断什么时候需要store中的操作，当这个组件触发的事件需要改变暂时存储的数据时，则需要store中的操作。如增加/删除购物车的商品，都属于需要修改暂时存储的数据。当这个组件需要获取将暂时存储的数据加工后的数据时，如获取购物车某件商品总价。
